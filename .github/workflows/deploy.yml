# deploy.yml

# å·¥ä½œæµç¨‹çš„åç¨±
name: Deploy Vue App to GitHub Pages

# è§¸ç™¼æ¢ä»¶ï¼šç•¶æ¨é€åˆ° main åˆ†æ”¯æ™‚è§¸ç™¼
on:
  push:
    branches: [ "main" ]

# å·¥ä½œæµç¨‹åŸ·è¡Œçš„æ¬Šé™è¨­å®š
permissions:
  contents: read
  pages: write
  id-token: write

# å·¥ä½œæµç¨‹ä¸­çš„ä½œæ¥­
jobs:
  build-and-deploy:
    # åœ¨æœ€æ–°ç‰ˆçš„ Ubuntu ä¸Šé‹è¡Œ
    runs-on: ubuntu-latest
    steps:
      # ç¬¬ä¸€æ­¥ï¼šCheckout æ‚¨çš„å„²å­˜åº«ç¨‹å¼ç¢¼
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v4

      # ç¬¬äºŒæ­¥ï¼šè¨­å®š Node.js ç’°å¢ƒ
      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # å»ºè­°ä½¿ç”¨ç›®å‰çš„ LTS ç‰ˆæœ¬
          cache: 'npm'

      # ç¬¬ä¸‰æ­¥ï¼šå®‰è£ä¾è³´å¥—ä»¶
      - name: Install dependencies
        run: npm install

      # ç¬¬å››æ­¥ï¼šå»ºç½®å°ˆæ¡ˆ (æ­¤æ­¥é©ŸæœƒåŸ·è¡Œ npm run build)
      - name: Build
        run: npm run build

      # ç¬¬äº”æ­¥ï¼šè¨­å®š GitHub Pages
      - name: Setup Pages
        uses: actions/configure-pages@v5

      # ç¬¬å…­æ­¥ï¼šä¸Šå‚³å»ºç½®å¥½çš„ç”¢ç‰© (dist è³‡æ–™å¤¾)
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: './dist'

      # ç¬¬ä¸ƒæ­¥ï¼šéƒ¨ç½²åˆ° GitHub Pages
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4